#!/bin/bash
# AI-assisted code review and safety check before push

echo "ğŸ§  Running Cosmopsychia Integrity Checks..."

# 1. Run Breath-Check safety scanner on C sources
if [ -f "breath-check/extension.py" ]; then
    echo "ğŸ” Executing Breath-Check (Medical Safety Scanner)..."
    python3 breath-check/extension.py tim_vm.c
    if [ $? -ne 0 ]; then
        echo "ğŸ›‘ Safety risks detected in C firmware! Push aborted."
        exit 1
    fi
fi

# 2. Run Cosmopsychia library unit tests
echo "ğŸ§ª Running Cosmopsychia Library Unit Tests..."
pytest
if [ $? -ne 0 ]; then
    echo "ğŸ›‘ Library tests failed! Push aborted."
    exit 1
fi

echo "âœ… AI review and library integrity checks passed. Ready to push!"
